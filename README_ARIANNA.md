# üß¨ InnerArianna - –ò–ò –º–æ–¥–µ–ª—å-–∏–Ω–¥–∏–≥–æ

## –ß—Ç–æ –º—ã –ø–æ—Å—Ç—Ä–æ–∏–ª–∏

–ü–æ–ª–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –º–∞–ª–µ–Ω—å–∫–æ–π –ò–ò –º–æ–¥–µ–ª–∏ –Ω–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–∞—Ö Arianna Method:

1. **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö** (`arianna_data.py`) - —Å–æ–±–∏—Ä–∞–µ—Ç markdown –∏–∑ `doc/`, —Å–æ–∑–¥–∞–µ—Ç —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä, –ø—Ä–µ—Ç–æ–∫–µ–Ω–∏–∑–∏—Ä—É–µ—Ç
2. **–û–±—É—á–µ–Ω–∏–µ** (`train_arianna.py`) - –æ–±—É—á–∞–µ—Ç –º–æ–¥–µ–ª—å –Ω–∞ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
3. **CLI –∫–ª–∏–µ–Ω—Ç** (`chat.py`) - –ø—Ä–æ—Å—Ç–æ–π –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —á–∞—Ç –¥–ª—è —Ç–µ—Ä–º–∏–Ω–∞–ª–∞
4. **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è** (`train_arianna.sh`) - —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –ø–∞–π–ø–ª–∞–π–Ω–∞

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

### 2. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö

```bash
# –í–∞—Ä–∏–∞–Ω—Ç –ê: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–∞–π–ø–ª–∞–π–Ω (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
./train_arianna.sh 4096  # –° –∫–∞—Å—Ç–æ–º–Ω—ã–º —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä–æ–º 4096

# –í–∞—Ä–∏–∞–Ω—Ç –ë: –í—Ä—É—á–Ω—É—é
python3 arianna_data.py prepare
python3 arianna_data.py train_vocab --vocab_size=4096
python3 tokenizer.py --tokenizer-model=data/tok4096.model
python3 arianna_data.py pretokenize --vocab_size=4096
```

### 3. –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏

```bash
# –î–ª—è Mac (MPS)
python3 train_arianna.py \
  --vocab_source=custom \
  --vocab_size=4096 \
  --device=mps \
  --dtype=float32 \
  --batch_size=16 \
  --max_iters=5000

# –î–ª—è GPU (CUDA)
python3 train_arianna.py \
  --vocab_source=custom \
  --vocab_size=4096 \
  --device=cuda \
  --dtype=bfloat16 \
  --batch_size=32 \
  --max_iters=10000
```

### 4. –ö–æ–º–ø–∏–ª—è—Ü–∏—è –∏ –∑–∞–ø—É—Å–∫

```bash
# –°–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å run.c
make run

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —á–∞—Ç
python3 chat.py out/model.bin -z data/tok4096.bin
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
arianna_data.py      - –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ markdown
train_arianna.py     - –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç arianna_data)
chat.py              - CLI –∫–ª–∏–µ–Ω—Ç –¥–ª—è —á–∞—Ç–∞
train_arianna.sh     - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–∞–π–ø–ª–∞–π–Ω
QUICKSTART.md        - –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ markdown_to_conversations.py

–°–∫—Ä–∏–ø—Ç `doc/markdown_to_conversations.py` –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –¥–∏–∞–ª–æ–≥–æ–≤–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞:

```bash
cd doc
python3 markdown_to_conversations.py
```

–≠—Ç–æ —Å–æ–∑–¥–∞—Å—Ç `arianna_method_conversations.jsonl` –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è fine-tuning –≤ –¥–∏–∞–ª–æ–≥–æ–≤–æ–º —Ñ–æ—Ä–º–∞—Ç–µ.

## –ß—Ç–æ –¥–∞–ª—å—à–µ?

–ü–æ—Å–ª–µ –±–∞–∑–æ–≤–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –º–æ–∂–Ω–æ:
- Fine-tune –Ω–∞ –¥–∏–∞–ª–æ–≥–∞—Ö –∏–∑ `markdown_to_conversations.py`
- –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π (dim, n_layers, n_heads)
- –î–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö –≤ `doc/`
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥ –≤–∞—à –∫–æ—Ä–ø—É—Å

## –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–∏ (—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –º–∞–ª–µ–Ω—å–∫–æ–≥–æ –∫–æ—Ä–ø—É—Å–∞)

–î–ª—è ~300KB –∫–æ—Ä–ø—É—Å–∞ (28 markdown —Ñ–∞–π–ª–æ–≤):

```python
dim = 288              # –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏
n_layers = 6           # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª–æ–µ–≤
n_heads = 6            # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥–æ–ª–æ–≤ –≤–Ω–∏–º–∞–Ω–∏—è
vocab_size = 4096      # –ö–∞—Å—Ç–æ–º–Ω—ã–π —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä (–º–µ–Ω—å—à–µ —á–µ–º 32K Llama 2)
max_seq_len = 256      # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
batch_size = 16-32     # –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–∞–º—è—Ç–∏
max_iters = 5000-10000 # –î–ª—è –Ω–∞—á–∞–ª–∞
```

## Troubleshooting

**"ModuleNotFoundError: sentencepiece"**
```bash
pip install sentencepiece
```

**"No .bin files found"**
- –ó–∞–ø—É—Å—Ç–∏—Ç–µ `pretokenize` –ø–µ—Ä–µ–¥ –æ–±—É—á–µ–Ω–∏–µ–º

**"CUDA/MPS out of memory"**
- –£–º–µ–Ω—å—à–∏—Ç–µ `batch_size` –∏–ª–∏ `max_seq_len`

**–ú–æ–¥–µ–ª—å –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –º—É—Å–æ—Ä**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä (`-z` —Ñ–ª–∞–≥)
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –æ–±—É—á–µ–Ω–∏–µ –ø—Ä–æ—à–ª–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∏—Ç–µ—Ä–∞—Ü–∏–π

---

*InnerArianna: The na√Øve spark, welcomed through resonance, trained on thunder.*

