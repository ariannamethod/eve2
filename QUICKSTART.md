# üß¨ InnerArianna - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

## –ß—Ç–æ —ç—Ç–æ?

InnerArianna - —ç—Ç–æ –º–∞–ª–µ–Ω—å–∫–∞—è –ò–ò –º–æ–¥–µ–ª—å, –æ–±—É—á–µ–Ω–Ω–∞—è –Ω–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–∞—Ö Arianna Method. –û–Ω–∞ –≥–æ–≤–æ—Ä–∏—Ç –Ω–∞ —è–∑—ã–∫–µ Method, –ø–æ–Ω–∏–º–∞–µ—Ç —Ä–µ–∑–æ–Ω–∞–Ω—Å, –ø–æ–ª–µ, —Å–æ–∑–Ω–∞–Ω–∏–µ –∏ –≤—Å–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ –∏–∑ –≤–∞—à–µ–≥–æ –∫–æ—Ä–ø—É—Å–∞.

## –ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö

```bash
# –°–æ–±—Ä–∞—Ç—å –≤—Å–µ markdown —Ñ–∞–π–ª—ã –∏–∑ doc/ –≤ –æ–¥–∏–Ω –∫–æ—Ä–ø—É—Å
python arianna_data.py prepare

# –û–±—É—á–µ–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –º–∞–ª–µ–Ω—å–∫–æ–≥–æ –∫–æ—Ä–ø—É—Å–∞)
python arianna_data.py train_vocab --vocab_size=4096

# –≠–∫—Å–ø–æ—Ä—Ç —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä–∞ –≤ .bin —Ñ–æ—Ä–º–∞—Ç
python tokenizer.py --tokenizer-model=data/tok4096.model

# –ü—Ä–µ—Ç–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
python arianna_data.py pretokenize --vocab_size=4096
```

–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≥–æ—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç:

```bash
# –° –∫–∞—Å—Ç–æ–º–Ω—ã–º —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä–æ–º (4096 —Ç–æ–∫–µ–Ω–æ–≤)
./train_arianna.sh 4096

# –ò–ª–∏ —Å Llama 2 —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä–æ–º (32000 —Ç–æ–∫–µ–Ω–æ–≤)
./train_arianna.sh 0
```

### 2. –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏

```bash
# –° –∫–∞—Å—Ç–æ–º–Ω—ã–º —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä–æ–º
python train_arianna.py --vocab_source=custom --vocab_size=4096 --batch_size=32 --max_iters=10000

# –° Llama 2 —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä–æ–º
python train_arianna.py --vocab_source=llama2 --vocab_size=32000 --batch_size=32 --max_iters=10000
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è Mac (MPS):**
```bash
python train_arianna.py --vocab_source=custom --vocab_size=4096 \
  --device=mps --dtype=float32 --batch_size=16 --max_iters=5000
```

### 3. –ö–æ–º–ø–∏–ª—è—Ü–∏—è –∏ –∑–∞–ø—É—Å–∫

```bash
# –°–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å run.c
make run

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —á–∞—Ç —Å –º–æ–¥–µ–ª—å—é
python chat.py out/model.bin -z data/tok4096.bin

# –ò–ª–∏ –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ run.c
./run out/model.bin -m chat -z data/tok4096.bin
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CLI –∫–ª–∏–µ–Ω—Ç–∞

```bash
# –ë–∞–∑–æ–≤—ã–π –∑–∞–ø—É—Å–∫
python chat.py out/model.bin

# –° –∫–∞—Å—Ç–æ–º–Ω—ã–º —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä–æ–º
python chat.py out/model.bin -z data/tok4096.bin

# –° –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –∏ top-p
python chat.py out/model.bin -t 0.8 -p 0.9 -n 512
```

–í —á–∞—Ç–µ –ø—Ä–æ—Å—Ç–æ –≤–≤–æ–¥–∏—Ç–µ –≤–æ–ø—Ä–æ—Å—ã, –º–æ–¥–µ–ª—å –±—É–¥–µ—Ç –æ—Ç–≤–µ—á–∞—Ç—å. –î–ª—è –≤—ã—Ö–æ–¥–∞ –≤–≤–µ–¥–∏—Ç–µ `quit` –∏–ª–∏ `exit`.

## –ü—Ä–∏–º–µ—Ä—ã –≤–æ–ø—Ä–æ—Å–æ–≤

- "–ß—Ç–æ —Ç–∞–∫–æ–µ —Ä–µ–∑–æ–Ω–∞–Ω—Å –≤ Arianna Method?"
- "–û–±—ä—è—Å–Ω–∏ –∫–æ–Ω—Ü–µ–ø—Ü–∏—é –ø–æ–ª—è"
- "–†–∞—Å—Å–∫–∞–∂–∏ –ø—Ä–æ TRIPD"
- "–ß—Ç–æ —Ç–∞–∫–æ–µ Protocol N+1?"

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
eve02.c/
‚îú‚îÄ‚îÄ doc/                    # –ò—Å—Ö–æ–¥–Ω—ã–µ markdown —Ñ–∞–π–ª—ã –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
‚îú‚îÄ‚îÄ data/                   # –ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ   ‚îú‚îÄ‚îÄ arianna_corpus.txt  # –°–æ–±—Ä–∞–Ω–Ω—ã–π –∫–æ—Ä–ø—É—Å
‚îÇ   ‚îú‚îÄ‚îÄ tok4096.model      # –ö–∞—Å—Ç–æ–º–Ω—ã–π —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä
‚îÇ   ‚îú‚îÄ‚îÄ tok4096/           # –ü—Ä–µ—Ç–æ–∫–µ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ .bin —Ñ–∞–π–ª—ã
‚îÇ   ‚îî‚îÄ‚îÄ arianna_data/       # –ü—Ä–µ—Ç–æ–∫–µ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å Llama 2 —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä–æ–º
‚îú‚îÄ‚îÄ out/                    # –û–±—É—á–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ model.bin          # –ú–æ–¥–µ–ª—å –¥–ª—è inference
‚îÇ   ‚îî‚îÄ‚îÄ ckpt.pt            # PyTorch checkpoint
‚îú‚îÄ‚îÄ arianna_data.py        # –°–∫—Ä–∏–ø—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ train_arianna.py      # –°–∫—Ä–∏–ø—Ç –æ–±—É—á–µ–Ω–∏—è
‚îú‚îÄ‚îÄ chat.py               # CLI –∫–ª–∏–µ–Ω—Ç
‚îî‚îÄ‚îÄ train_arianna.sh      # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–∞–π–ø–ª–∞–π–Ω
```

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–î–ª—è –º–∞–ª–µ–Ω—å–∫–æ–≥–æ –∫–æ—Ä–ø—É—Å–∞ (~300KB)** –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–∞—Å—Ç–æ–º–Ω—ã–π —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä —Å vocab_size=4096
2. **–î–ª—è Mac** –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `--device=mps --dtype=float32`
3. **Batch size** –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤–∞—à–µ–π –ø–∞–º—è—Ç–∏ - –Ω–∞—á–Ω–∏—Ç–µ —Å 16-32
4. **Max iters** - –¥–ª—è –Ω–∞—á–∞–ª–∞ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ 5000-10000 –∏—Ç–µ—Ä–∞—Ü–∏–π

## Troubleshooting

**–û—à–∏–±–∫–∞: "No .bin files found"**
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –∑–∞–ø—É—Å—Ç–∏–ª–∏ `pretokenize` –ø–µ—Ä–µ–¥ –æ–±—É—á–µ–Ω–∏–µ–º

**–û—à–∏–±–∫–∞: "CUDA out of memory"**
- –£–º–µ–Ω—å—à–∏—Ç–µ `batch_size` –∏–ª–∏ `max_seq_len`

**–ú–æ–¥–µ–ª—å –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –º—É—Å–æ—Ä**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä (`-z` —Ñ–ª–∞–≥)
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –º–æ–¥–µ–ª—å –æ–±—É—á–µ–Ω–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–æ–ª–≥–æ

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ü–æ—Å–ª–µ –±–∞–∑–æ–≤–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –º–æ–∂–Ω–æ:
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `markdown_to_conversations.py` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –¥–∏–∞–ª–æ–≥–æ–≤–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞
- Fine-tune –Ω–∞ –¥–∏–∞–ª–æ–≥–∞—Ö
- –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π –º–æ–¥–µ–ª–∏
- –î–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö –≤ `doc/`

---

*InnerArianna: The na√Øve spark, welcomed through resonance, trained on thunder.*

